import subprocess
import json
import logging
from typing import Tuple, Optional, Dict, Any


def scan_image(image: str) -> Tuple[Optional[Dict[str, Any]], Optional[str]]:
    result = subprocess.run(
        ["trivy", "--scanners", "vuln,secret", "image", "-f", "json", image],
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        text=True
    )
    if result.returncode != 0:
        logging.error(f"Error scanning image {image}: {result.stderr}")
        return None, result.stderr
    return json.loads(result.stdout), None
